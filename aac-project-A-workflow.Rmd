---
title: "aac-project-A-workflow"
author: "Rick Gilmore"
date: "`r Sys.time()`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Background

This document describes a preliminary workflow for processing the "manifest" files generated by Christophe Gerard's script. The BitBucket repo for the current code is here: <https://bitbucket.org/cgerard/aac_visual_search>

## File organization

From the parent directory, there is an `assets/` folder with the `*.jpg` versions of the individual symbol icons, a `data/` folder which will hold the by-subject "raw" output files from Tobii in a `*.csv` format, and an `output/` folder which holds a set of by-subject directories. Within each subject-specific directory there are a set of `*.bmp` image files for each of the $n$=32 trials. The images summarize the sequence of gaze positions along with some summary statistical information. There is also a "manifest" file in the form of `RO1_A_pos_manifest.csv`. The latter file is the one we want to load and parse.

```{r set-up-paths-copy-data-files}
dropbox.dir <- "~/Dropbox/aac_visual_search (1)/2017_05_03/output/CJ/"
manifest.fn <- "RO1_A_pos_manifest.csv" # Note not 0
data.dir <- "analysis/data/CJ/"

# Manifest file
if (file.exists(paste0(dropbox.dir))) {
  files <- list.files(path = dropbox.dir, full.names = TRUE)
  lapply(files, file.copy, to = data.dir)
}
```

## Load manifest file

```{r load-file-clean}
sub.data <- read.csv(paste0(data.dir, manifest.fn))
```

The manifest file contains the following variables:

<!-- This could be modified to use levels() -->

- **aoi**: string, Area of Interest (AOI) label in <trial><project>-<layout>-<icon> format where 
    - <trial> is [1..32]
    - <project> is "A"
    - <layout> is {"CLOC", "CORN", "SOC", "WIDE"}
    - and <icon> is {"BABY", "BALL", "BOY", "CLIMBING", "COLD", "GIRL", "HAPPY", "HOT", "LADDER", "ME", "SAD", "SLIDE", "SLIDING", "SWING", "SWINGING", "THROWING}.
- **trialnum**: integer, [1..32]
- **layout**: string, {"CLOC", "CORN", "SOC", "WIDE"}
- **target**: string, {"A", "B", "C", "D", "x", "X"}
- **stimulus**: string, {"BABY", "BALL", "BOY", "CLIMBING", "COLD", "GIRL", "HAPPY", "HOT", "LADDER", "ME", "SAD", "SLIDE", "SLIDING", "SWING", "SWINGING", "THROWING", "ALL""}
- **part4**: string, {"", "1", "2", "3", "T"}
- **fixations**: integer, [0..n]
- **x1, y1, x2, y2, x3, y3, x4, y4**: number, X (horiz) and Y (vert) coordinates of AOI rectangles.

Here is a table showing the icons by semantic category:

| Category | Icon 1                | Icon 2              | Icon 3                           |            Icon 4 |
|----------|-----------------------|---------------------|----------------------------------|-------------------|
| People   | ![BABY](img/baby.jpg) | ![BOY](img/boy.jpg) | ![GIRL](img/girl.jpg) | ![ME](img/me.jpg) |
| Things   | ![BALL](img/ball.jpg) | ![LADDER](img/ladder.jpg) | ![SLIDE](img/slide.jpg) | ![SWING](img/swing.jpg) |
| Actions  | ![CLIMBING](img/climbing.jpg) | ![SLIDING](img/sliding.jpg) | ![SWINGING](img/swinging.jpg) | ![THROWING](img/throwing.jpg) |
| Feelings | ![COLD](img/cold.jpg) | ![HAPPY](img/happy.jpg) | ![HOT](img/hot.jpg) | ![SAD](img/sad.jpg) | 

## Trial by trial summaries

```{r trial-by-trial-summary, results="as-is", eval=FALSE, include=FALSE}
# test function to automatically generate RMarkdown for each trial
Print.trial.summ <- function(trial.num, img.partial.nm = "analysis/data/CJ/R01_A_WO1_CJ_"){
  cat(sprintf("### Trial %s\n\n", trial.num))
  cat(sprintf("![Trial %s](%s)\n\n", trial.num, paste0(img.partial.nm, trial.num, ".bmp") ))
}

trials <- sprintf("%02s", seq(1:32))
lapply(trials, Print.trial.summ)
```

### Trial 01

![Trial 01](analysis/data/CJ/R01_A_WO1_CJ_01.bmp)

### Trial 02

![Trial 02](analysis/data/CJ/R01_A_WO1_CJ_02.bmp)

### Trial 03

![Trial 03](analysis/data/CJ/R01_A_WO1_CJ_03.bmp)

### Trial 04

![Trial 04](analysis/data/CJ/R01_A_WO1_CJ_04.bmp)

### Trial 05

![Trial 05](analysis/data/CJ/R01_A_WO1_CJ_05.bmp)

### Trial 06

![Trial 06](analysis/data/CJ/R01_A_WO1_CJ_06.bmp)

### Trial 07

![Trial 07](analysis/data/CJ/R01_A_WO1_CJ_07.bmp)

### Trial 08

![Trial 08](analysis/data/CJ/R01_A_WO1_CJ_08.bmp)

### Trial 09

![Trial 09](analysis/data/CJ/R01_A_WO1_CJ_09.bmp)

### Trial 10

![Trial 10](analysis/data/CJ/R01_A_WO1_CJ_10.bmp)

### Trial 11

![Trial 11](analysis/data/CJ/R01_A_WO1_CJ_11.bmp)

### Trial 12

![Trial 12](analysis/data/CJ/R01_A_WO1_CJ_12.bmp)

### Trial 13

![Trial 13](analysis/data/CJ/R01_A_WO1_CJ_13.bmp)

### Trial 14

![Trial 14](analysis/data/CJ/R01_A_WO1_CJ_14.bmp)

### Trial 15

![Trial 15](analysis/data/CJ/R01_A_WO1_CJ_15.bmp)

### Trial 16

![Trial 16](analysis/data/CJ/R01_A_WO1_CJ_16.bmp)

### Trial 17

![Trial 17](analysis/data/CJ/R01_A_WO1_CJ_17.bmp)

### Trial 18

![Trial 18](analysis/data/CJ/R01_A_WO1_CJ_18.bmp)

### Trial 19

![Trial 19](analysis/data/CJ/R01_A_WO1_CJ_19.bmp)

### Trial 20

![Trial 20](analysis/data/CJ/R01_A_WO1_CJ_20.bmp)

### Trial 21

![Trial 21](analysis/data/CJ/R01_A_WO1_CJ_21.bmp)

### Trial 22

![Trial 22](analysis/data/CJ/R01_A_WO1_CJ_22.bmp)

### Trial 23

![Trial 23](analysis/data/CJ/R01_A_WO1_CJ_23.bmp)

### Trial 24

![Trial 24](analysis/data/CJ/R01_A_WO1_CJ_25.bmp)

### Trial 25

![Trial 25](analysis/data/CJ/R01_A_WO1_CJ_25.bmp)

### Trial 26

![Trial 26](analysis/data/CJ/R01_A_WO1_CJ_26.bmp)

### Trial 27

![Trial 27](analysis/data/CJ/R01_A_WO1_CJ_27.bmp)

### Trial 28

![Trial 28](analysis/data/CJ/R01_A_WO1_CJ_28.bmp)

### Trial 29

![Trial 29](analysis/data/CJ/R01_A_WO1_CJ_29.bmp)

### Trial 30

![Trial 30](analysis/data/CJ/R01_A_WO1_CJ_30.bmp)

### Trial 31

![Trial 31](analysis/data/CJ/R01_A_WO1_CJ_31.bmp)

### Trial 32

![Trial 32](analysis/data/CJ/R01_A_WO1_CJ_32.bmp)

## Cleaning and summarizing manifest file


